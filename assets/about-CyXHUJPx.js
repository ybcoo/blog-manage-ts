import{d as C,A as B,r as k,c as r,g as S,o as d,e as s,f as g,a as w,K as h,L as V,t as I,O as A,C as N,p as M,w as P,P as T,h as L,M as F}from"./index-Bwdm9_s4.js";import{F as z,D as E}from"./FishInput-Cweopgfz.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{b as O,e as j,f as K}from"./api-VzFshU4K.js";import{i as R}from"./svg-ioeJ66Oq.js";const q={key:0,class:"popContainer"},G={class:"middle"},H={class:"bottom"},J=C({__name:"PopUp",props:{modelValue:{type:Boolean},popItem:{}},emits:["update:modelValue","update:popItem","updateUser"],setup(v,{emit:b}){const c=v,f=B({get:()=>c.popItem?.role,set:l=>n("update:popItem",{...c.popItem,role:l})}),a=B({get:()=>c.popItem?.account,set:l=>n("update:popItem",{...c.popItem,account:l})}),o=k([{label:"admin",value:"admin"},{label:"user",value:"user"}]),n=b;return(l,e)=>v.modelValue?(d(),r("div",q,[e[4]||(e[4]=s("div",{class:"header"},[s("span",null,"Edit Info")],-1)),s("div",G,[g(z,{modelValue:a.value,"onUpdate:modelValue":e[0]||(e[0]=t=>a.value=t),placeholder:"请输入用户名"},null,8,["modelValue"]),g(E,{options:o.value,modelValue:f.value,"onUpdate:modelValue":e[1]||(e[1]=t=>f.value=t)},null,8,["options","modelValue"])]),s("div",H,[s("button",{class:"editBtn",onClick:e[2]||(e[2]=t=>n("update:modelValue",!1))},"Cancel"),s("button",{class:"editBtn",onClick:e[3]||(e[3]=t=>n("updateUser"))},"Save")])])):S("",!0)}}),Q=$(J,[["__scopeId","data-v-d6196f50"]]),W={class:"table"},X=["onClick"],Y=C({__name:"TableA",props:{columns:{},list:{}},emits:["updateUser"],setup(v,{emit:b}){const c=w(),f=b,a=k(null),o=k(!1),n=l=>{c.role==="admin"&&(a.value=l,o.value=!o.value)};return(l,e)=>(d(),r("table",W,[s("thead",null,[s("tr",null,[(d(!0),r(h,null,V(v.columns,t=>(d(),r("th",{key:t.key},I(t.label),1))),128))])]),s("tbody",null,[(d(!0),r(h,null,V(v.list,(t,y)=>(d(),r("tr",{key:y,onClick:i=>n(t)},[(d(!0),r(h,null,V(v.columns,i=>(d(),r("td",{key:i.key},[A(l.$slots,i.key,{row:t,value:t[i.key],rowIndex:y,col:i},()=>[N(I(t[i.key]),1)],!0)]))),128))],8,X))),128))]),g(Q,{modelValue:o.value,"onUpdate:modelValue":e[0]||(e[0]=t=>o.value=t),popItem:a.value,"onUpdate:popItem":e[1]||(e[1]=t=>a.value=t),onUpdateUser:e[2]||(e[2]=t=>{f("updateUser",a.value),o.value=!1})},null,8,["modelValue","popItem"])]))}}),Z=$(Y,[["__scopeId","data-v-e17b533c"]]),ee={class:"userPage"},te={class:"tableContainer"},ae=["src"],se=["onClick"],oe={class:"bottom"},le=["disabled"],ne=["disabled"],ue=C({__name:"about",setup(v){const b=w(),{userAvatar:c}=R,f=[{label:"ID",key:"id"},{label:"Account",key:"account"},{label:"Avatar",key:"url"},{label:"Role",key:"role"},{label:"IP",key:"location"},{label:"CreateTime",key:"createTime"}];b.role==="admin"&&f.push({label:"Operation",key:"operation"});const a=k(1),o=k(1),n=k(10),l=k([]),e=async()=>{try{const p=await O({pageNum:a.value,pageSize:n.value}),{code:m,data:u}=p.data,{list:_,total:U}=u??{};m===0&&(l.value=_,o.value=Math.ceil(U/n.value))}catch(p){console.error(p)}},t=async p=>{try{const m=await j({id:p,isDelete:1,userId:b.userId}),{code:u,data:_}=m.data;u===0&&(a.value=1,await e())}catch(m){console.error(m)}},y=async({id:p,account:m,role:u}={})=>{try{const _=await K({id:p,userId:b.userId,account:m,role:u}),{code:U,data:x}=_.data;U===0?(a.value=1,await e()):x?.message&&F.error(x.message)}catch(_){console.error(_)}},i=()=>{a.value>1&&(a.value-=1,e())},D=()=>{a.value<o.value&&(a.value+=1,e())};return M(async()=>{await e()}),(p,m)=>(d(),r("div",ee,[s("div",te,[g(Z,{columns:f,list:l.value,onUpdateUser:y},{url:P(({row:u})=>[s("img",{src:u.url??L(c),alt:"avatar",style:{width:"50px",height:"50px","border-radius":"50%","object-fit":"cover"}},null,8,ae)]),operation:P(({row:u})=>[s("button",{class:"pageBtn",onClick:T(_=>t(u.id),["stop"])},"Delete",8,se)]),_:1},8,["list"])]),s("div",oe,[s("button",{class:"pageBtn",disabled:a.value===1,onClick:i},"last",8,le),s("span",null,I(a.value)+"/"+I(o.value),1),s("button",{class:"pageBtn",disabled:a.value===o.value,onClick:D},"next",8,ne)])]))}}),me=$(ue,[["__scopeId","data-v-0f60420d"]]);export{me as default};
